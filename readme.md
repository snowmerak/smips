# smips

smips는 단순하지만 합리적인 구조를 가지진 않은 가상 머신입니다.

## Op Code

smips는 두 가지 형태의 opcode를 가집니다.

`8 bit data, 16 bit ra, 16 bit rb, 16 bit rd, 8 bit op`

`40 bit wide-data, 16 bit rd, 8 bit op`

첫번째 케이스는 8 비트 데이터, 16 비트 레지스터 주소 3개, 8 비트 오퍼레이션가집니다. 이 케이스의 opcode는 거의 대부분의 연산에 쓰입니다. 

두번째 케이스는 40 비트 데이터와 16 비트 레지스터 주소 1개, 8 비트 오퍼레이션을 가지며, 이 경우는 제한된 연산에만 쓰입니다.

각 연산에 대한 코드는 [op.go](opcode/op.go) 파일에 주석과 함께 작성되어 있습니다.

## Memory

smips의 메모리는 고 언어의 해시맵을 그대로 사용하여 오프셋과 함께 나타냅니다.

메모리 최소 단위는 `uint8`이고 주소값과 내부 오프셋으로 접근할 수 있습니다.

자세한 사항은 [memory.go](memory/memory.go) 파일에 주석과 함께 작성되어 있습니다.

## Register

smips의 레지스터는 극단적으로 단순한 형태를 취합니다. 

총 65536개의 `uint64`로 이루어진 저장 공간을 가지며 0, 1, 2, 3은 예약 공간, 16838개의 패러미터, 엑스트라, 임시, 반환 값을 저장하는 레지스터로 구성되어 있습니다. 

이 중 엑스트라 구역은 하위 프로세스를 호출했을 때 매개변수로 넘어가는 데이터이며 하위 프로세스가 종료되었을 때 반환값으로 치환됩니다.

자세한 사항은 [reg.go](register/reg.go) 파일에 주석과 함께 작성되어 있습니다.

## Process

smips의 실행 단위입니다.

smips는 하나의 메인 프로세스가 하위의 여러 프로세스를 동작 시켜서 실행 값을 가져옵니다.

이때 프로세스 하나가 스택 하나 이상을 가질 수 있지만 실행이 완료되면 하나의 레지스터만 가져야합니다.

자세한 사항은 [process.go](process/process.go) 파일에 주석과 함께 작성되어 있습니다.
